(function(a,b,c,d){"use strict";a.devicePixelRatio=b.devicePixelRatio&&b.devicePixelRatio>1?b.devicePixelRatio:1;a.bandwidth="low";a.connKbps;a.connTestResult;a.connType;a.images=[];a.options=a.options||{};var e=a.options,f=e.testConn||true,g=e.minKbpsForHighBandwidth||400,h=e.speedTestUri||"http://foresightjs.appspot.com/speed-test/50K",i=e.speedTestKB||50,j=e.speedTestExpireMinutes||30,k,l,m="loading",n="complete",o="fsjs",p="browserWidth",q="browserHeight",r="requestWidth",s="requestHeight",t="width",u="height",v=true,w=false,x=function(){if(k)return;k=m;if(e.forcedPixelRatio){a.devicePixelRatio=e.forcedPixelRatio}if(e.forcedBandwidth){a.bandwidth=e.forcedBandwidth}y();k=n;B()},y=function(){var b,d,e,f=/url\((?:([a-zA-Z-_0-9{}\\//.:\s]+))\)/g,g,h,i,j,k;for(b=0;b<c.images.length;b++){d=c.images[b];if(!d.initalized){d.initalized=v;d.orgSrc=z(d,"src");d.widthUnits=z(d,t,true);d.heightUnits=z(d,u,true);if(!d.orgSrc||!d.widthUnits||!d.heightUnits)continue;d[r]=0;d[s]=0;d.highResolutionSrc=z(d,"high-resolution-src");d.orgClassName=d.className?d.className:"";g=F(d,"font-family","fontFamily").split("image-set(");d.imageSet=[];if(g.length>1){h=g[1].split(",");for(j=0;j<h.length;j++){i={uriTemplate:null,scaleFactor:null,bandwidth:null,text:h[j]};if(i.text.indexOf(" 2x")>-1){i.scaleFactor=2}else if(i.text.indexOf(" 1.5x")>-1){i.scaleFactor=1.5}else{i.scaleFactor=a.devicePixelRatio}if(i.text.indexOf("high-bandwidth")>-1){i.bandwidth="high"}else{i.bandwidth=a.bandwidth}while(k=f.exec(i.text)){if(k[1]!=null){i.uriTemplate=k[1]}}d.imageSet.push(i)}}d.onerror=L;a.images.push(d)}}},z=function(a,b,c){var d=a.getAttribute("data-"+b);if(c){return A(d)}return d},A=function(a){if(!isNaN(a)){return parseInt(a,10)}return 0},B=function(){if(!(l===n&&k===n))return;var b,c=a.images.length,d,e,f,g,h,i,j,m=[],o,t,u;for(b=0;b<c;b++){d=a.images[b];if(!C(d)){continue}h=d.orgClassName.split(" ");D(d);if(d.unitType=="pixel"){j="fs-"+d[p]+"x"+d[q];h.push(j);m.push("."+j+"{width:"+d[p]+"px;height:"+d[q]+"px}")}if(d.style.display!="inline"){d.style.display="inline"}d.uriTemplate=null;d.scaleFactor=a.devicePixelRatio;d.bandwidth=a.bandwidth;for(t=0;t<d.imageSet.length;t++){u=d.imageSet[t];if(a.bandwidth===u.bandwidth&&a.devicePixelRatio===u.scaleFactor){d.uriTemplate=u.uriTemplate;d.scaleFactor=u.scaleFactor;d.bandwidth=u.bandwidth}else if(a.devicePixelRatio===u.scaleFactor){d.uriTemplate=u.uriTemplate;d.scaleFactor=u.scaleFactor}else if(a.bandwidth===u.bandwidth){d.uriTemplate=u.uriTemplate;d.bandwidth=u.bandwidth}}if(d.bandwidth==="high"&&d.scaleFactor>1){e=Math.round(d[p]*d.scaleFactor);f=Math.round(d[q]*d.scaleFactor);a.hiResEnabled=v;h.push("fs-high-resolution")}else{e=d[p];f=d[q];a.hiResEnabled=w;h.push("fs-standard-resolution")}if(e>d[r]){d[r]=e;d[s]=f;if(d.highResolutionSrc&&a.hiResEnabled){if(d.highResolutionSrc!==d.src){d.src=d.highResolutionSrc}d.srcModification="src-hi-res"}else if(d.uriTemplate){I(d);d.srcModification="src-uri-template"}else{K(d);d.srcModification="src-replace-dimensions"}d.requestChange=v}else{d.requestChange=w}h.push("fs-"+d.srcModification);d.className=h.join(" ")}if(m.length){H(m)}if(a.updateComplete){a.updateComplete()}P=R()},C=function(a,b){b=a.parentElement;if(b.clientWidth){return v}if(F(b,"display","display")==="inline"){return C(b)}return w},D=function(a,b){if(!a.unitType){b=F(a,t,t);if(b.indexOf("%")>0){a.unitType="percent"}else{a.unitType="pixel";a[p]=a.widthUnits;a[q]=a.heightUnits}}if(a.unitType==="percent"){a.computedWidth=E(a);a[p]=a.computedWidth;a[q]=Math.round(a.heightUnits*(a.computedWidth/a.widthUnits));a.style.height=a[q]+"px"}},E=function(a){if(a.offsetWidth!==0){return a.offsetWidth}else{var b,c,d={},e={position:"absolute",visibility:"hidden",display:"block"};for(c in e){d[c]=a.style[c];a.style[c]=e[c]}b=a.offsetWidth;for(c in e){a.style[c]=d[c]}return b}},F=function(a,b,d){return a.currentStyle?a.currentStyle[d]:c.defaultView.getComputedStyle(a,null).getPropertyValue(b)},G,H=function(a){if(!G){G=c.createElement("style");G.setAttribute("type","text/css")}var b=a.join("");try{G.innerText=b}catch(d){G.styleSheet.cssText=b}if(G.parentElement==null){c.getElementsByTagName("head")[0].appendChild(G)}},I=function(a){var b,c=["src","protocol","host","port","directory","file","filename","ext","query","requestWidth","requestHeight","scaleFactor"],d=a.uriTemplate;a.uri=J(a.orgSrc);a.uri.src=a.orgSrc;a.uri[r]=a[r];a.uri[s]=a[s];a.uri.scaleFactor=a.scaleFactor;for(b=0;b<c.length;b++){d=d.replace("{"+c[b]+"}",a.uri[c[b]])}if(d!==a.src){a.src=d}},J=function(a){var b={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},c=b.parser.exec(a),d={},e=14;while(e--)d[b.key[e]]=c[e]||"";d[b.q.name]={};d[b.key[12]].replace(b.q.parser,function(a,c,e){if(c)d[b.q.name][c]=e});var f=d.file.split(".");d.filename=f[0];d.ext=f.length>1?f[f.length-1]:"";return d},K=function(a){var b=a.orgSrc.replace(a.widthUnits,"{requestWidth}").replace(a.heightUnits,"{requestHeight}");b=b.replace("{requestWidth}",a[r]).replace("{requestHeight}",a[s]);if(a.src!==b){a.src=b}},L=function(a){if(!a||!a.target||a.target.hadError)return;a.target.hadError=v;a.target.src=img.orgSrc;a.target.srcModification="response-error"},M=function(){if(l)return;if(a.devicePixelRatio===1){a.connTestResult="skip";l=n;return}a.connType=d.connection&&d.connection.type?d.connection.type.toString().toLowerCase():"unknown";if(a.connType!=="unknown"){var b,e=["2g","3g"];for(b=0;b<e.length;b++){if(a.connType.indexOf(e[b])>-1){a.connTestResult="connTypeSlow";l=n;return}}}try{var f=JSON.parse(localStorage.getItem(o));if(f!==null){if((new Date).getTime()<f.expires){a.bandwidth=f.bandwidth;a.connKbps=f.connKbps;a.connTestResult="localStorage";l=n;return}}}catch(j){}var k=c.createElement("img"),p,q,r;k.onload=function(){p=(new Date).getTime();var b=(p-q)/1e3;b=b>1?b:1;var c=i*1024*8;a.connKbps=c/b/1024;a.bandwidth=a.connKbps>=g?"high":"low";N("networkSuccess")};k.onerror=function(){N("networkError",5)};k.onabort=function(){N("networkAbort",5)};q=(new Date).getTime();l=m;if(c.location.protocol==="https:"){h=h.replace("http:","https:")}k.src=h+"?r="+Math.random();r=i*8/g*1e3+350;setTimeout(function(){N("networkSlow")},r)},N=function(b,c){if(l===n)return;l=n;a.connTestResult=b;try{if(!c){c=j}var d={connKbps:a.connKbps,bandwidth:a.bandwidth,expires:(new Date).getTime()+c/60/1e3};localStorage.setItem(o,JSON.stringify(d))}catch(e){}B()},O=function(){if(b.addEventListener){b.addEventListener("resize",Q,w)}else if(b.attachEvent){b.attachEvent("onresize",Q)}},P=0,Q=function(){if(P!==R()){a.reload()}},R=function(){return c.documentElement.clientWidth||c.body&&c.body.clientWidth||undefined},S,T=function(){if(k!==n||l!==n)return;y();B()};a.reload=function(){b.clearTimeout(S);S=b.setTimeout(T,300)};b.foresightReady=function(){if(!c.body){return setTimeout(b.foresightReady,1)}x()};if(c.readyState===n){setTimeout(foresightReady,1)}else{if(c.addEventListener){c.addEventListener("DOMContentLoaded",x,w);b.addEventListener("load",x,w)}else if(c.attachEvent){c.attachEvent("onreadystatechange",x);b.attachEvent("onload",x)}}M();O()})(this.foresight=this.foresight||{},this,document,navigator)